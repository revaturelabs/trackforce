<div class="container">
  <button id='new-interview' type="button" class="btn btn-primary" (click)="toggleForm()">New Interview</button>
  <div class="row" *ngIf="formOpen" class="toggledContainer">
    <div class="col-lg-9">
      <form class="form-horizontal">

        <div class="form-group">
          <label class="control-label col-sm-3">Client:</label>
          <div class="col-sm-3">
            <select class="form-control" name="newClient" [(ngModel)]="clientId">
              <option selected="selected">None</option>
              <option *ngFor="let client of clients" [ngValue]="client">{{client.name}}</option>
            </select>
          </div>
        </div>
        <!-- form-group end-->

        <div class="form-group">
          <label class="control-label col-sm-3">Date of interview:</label>
          <div class="col-sm-3">
            <input type="datetime-local" class="form-control" name="date" [(ngModel)]="interviewDate" />
          </div>
        </div>

        <div class='form-group'>
          <label class="control-label col-sm-3">Date Assigned:</label>
          <div class="col-sm-3">
            <input type="datetime-local" class="form-control" name="date" [(ngModel)]="interviewAssigned" />
          </div>
        </div>


        <div class="form-group">
          <label class="control-label col-sm-3">Type:</label>
          <div class="col-sm-3">
            <select class="form-control" name="type" [(ngModel)]="typeId">
              <option value="1">Phone</option>
              <option value="2">Online</option>
              <option value="3">On-site</option>
              <option value="4">Skype</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label class="control-label col-sm-3">24 hour notice?</label>
          <input type="checkbox" name="24hournotice" [(ngModel)]="was24HRNotice">
        </div>

        <button id='add-interview' (click)="addInterview()" class="btn btn-success">Add Interview</button>

      </form>
    </div>
  </div>

  <div class="card-deck mb-3 text-center">
    <div>
      <h3>My Interviews</h3>
      <div *ngIf="conflictingInterview" class="alert alert-danger">
        {{conflictingInterviews}}
      </div>
      <table class="table table-responsive table-hover table-bordered">
        <thead>
          <tr>
            <th>Interview</th>
            <th>Client</th>
            <th>Date Notified</th>
            <th>Interview Date</th>
            <th>Medium</th>
            <th>Job Description</th>
            <th>24 hour notice?</th>
            <th>Feedback</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let interview of interviews; let i = index">
            <td>{{i+1}}</td>
            <td>{{ (interview.client && interview.client.name) ? interview.client.name : ""}}</td>

            <td>
              <div *ngIf="i !== index">
                {{ interview.dateAssociateIssued | date:'MM/dd/yyyy, hh:mm a'}}
                <br>
                <button class="icon-button" type="button" (click)='showDateNotified(i)'>
                  <i class="glyphicon glyphicon-pencil pencil" style="font-size:15px"></i>
                </button>
              </div>
              <div *ngIf="i === index">
                <input id="date" #date type="datetime-local" [ngModel]="interview.dateAssociateIssued | date:'yyyy-MM-ddTHH:mm'" (ngModelChange)="interview.dateAssociateIssued=$event">
                <button type="button" (click)='showDateNotified(-1)'>
                  <i class="glyphicon glyphicon-pencil pencil" style="font-size:24px"></i>
                </button>
              </div>
            </td>

            <td>
              <div *ngIf="i !== index2" [ngStyle]="{'background-color': highlightInterviewConflicts(i) ? 'rgba(255,0,0,0.5)':''}">
                {{ interview.interviewDate | date:'MM/dd/yyyy, hh:mm a'}}
                <br>
                <button class="icon-button" type="button" (click)='showInterviewDate(i)'>
                  <i class="glyphicon glyphicon-pencil pencil" style="font-size:15px"></i>
                </button>
              </div>
              <div *ngIf="i === index2">
                <input id="date" #date2 type="datetime-local" [ngModel]="interview.interviewDate | date:'yyyy-MM-ddTHH:mm'" (ngModelChange)="interview.interviewDate=$event">
                <button type="button" (click)='showInterviewDate(-1)'>
                  <i class="glyphicon glyphicon-pencil pencil" style="font-size:24px"></i>
                </button>
              </div>
            </td>

            <td>{{ (interview.interviewType && interview.interviewType.name) ? interview.interviewType.name : "" }}</td>

            <td>{{ (interview.jobDescription) ? interview.jobDescription : "" }}</td>

            <td class="flag">
              <input type="checkbox" id="flag" [(ngModel)]="interview.was24HRNotice" [disabled]=true>
            </td>

            <td>
              <a [routerLink]="['/interview-details', interview.id]" class="id">view</a>
            </td>

            <td>
              <button type="button" class="btn btn-primary" (click)='updateInterview(interview)'>Update</button>
            </td>

          </tr>
        </tbody>
      </table>
      <div class="center-div" *ngIf="!isDataReady">
        <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
      </div>
    </div>
  </div>
</div>