<div class="container-fluid vertical-center">

  <div id="background">
    <img src="assets\images\23.jpg" alt="background" />
  </div>

  <div class="container col-7" id="bucket-container">
    <h1 class="display-1 text-center" id="header">S3<span id="bucket">Bucket</span></h1>


    <ul class="nav nav-tabs mt-5">
      <li class="nav-item">
        <a class="nav-link active" data-toggle="tab" href="#view-reports" aria-selected="true">
          <h3>View Reports</h3>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#upload-reports" aria-selected="false">
          <h3>Upload Report</h3>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#edit-reports" aria-selected="false">
          <h3>Edit Report</h3>
        </a>
      </li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane fade show active" id="view-reports">
        <div class="row mt-3">
          <div class="col ml-auto">
            <div class="list-group">
              <label for="lblSelectProject">Select a Project</label>
              <select id="projectChoice" class="form-control" [(ngModel)]="projectChoice" name="projectChoice"
                (change)=showIterations()>
                <option *ngFor="let project of projectList | async" [value]="project">{{project}}</option>
              </select>
            </div>
          </div>
          <div class="col mr-auto">
            <h4 *ngIf="iterationList != undefined">Iterations</h4>
            <div *ngFor="let iter of iterationList | async">
              <div class="panel-body">
                <a [href]="iterationLink" target="blank" (click)="createLink(iter)">{{iter}}</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div (change)="validate()" class="tab-pane fade" id="upload-reports">
        <h5 class="mx-auto mt-4">Sprint Metrics</h5>
        <div class="row">
          <div class="col">
            <label for="start-date">Start Date</label>
            <input type="date" id="start-date" [(ngModel)]="inputStartDate" class="form-control"
              placeholder="mm/dd/yyyy">
          </div>
          <div class="col">
            <label for="end-date">End Date</label>
            <input type="date" id="end-date" [(ngModel)]="inputEndDate" class="form-control" placeholder="mm/dd/yyyy">
          </div>
          <div class="col">
            <label for="completed">Completed SP's</label>
            <input type="number" id="completed" [(ngModel)]="completedStoryPoints" class="form-control"
              placeholder="00">
          </div>
          <div class="col">
            <label for="assigned">Assigned SP's</label>
            <input type="number" id="assigned" [(ngModel)]="assignedStoryPoints" class="form-control" placeholder="00">
          </div>
        </div>
        <h5 class="mx-auto mt-3">Iteration Information</h5>
        <div class="row">
          <div class="col">
            <div class="input-group mx-auto mt-3">
              <div class="input-group-prepend">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown"
                  aria-haspopup="true" aria-expanded="false">Project</button>
                <div class="dropdown-menu">
                  <p class="dropdown-item" (click)="setProject('Trackforce')">Trackforce</p>
                  <p class="dropdown-item" (click)="setProject('Rideforce')">Rideforce</p>
                  <p class="dropdown-item" (click)="setProject('SMS')">SMS</p>
                  <p class="dropdown-item" (click)="setProject('CMS')">CMS</p>
                </div>
              </div>
              <input type="text" class="form-control" [(ngModel)]="iteration" placeholder="Enter iteration...">
              <div class="input-group-append ml-2">
                <div class="custom-file">
                  <input type="file" id="upload" class="custom-file-input" (change)="selectFiles($event)">
                  <label class="custom-file-label" for="upload">Upload Files...</label>
                </div>
                <button class="btn btn-secondary ml-2" type="button" (click)="submit()"
                  [disabled]="!complete">Submit</button>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <ng-container *ngIf="incorrectDateAlert">
            <div class="alert alert-danger mx-auto mt-3 text-center" role="alert">
              Start date must be before end date.
            </div>
          </ng-container>
          <ng-container *ngIf="incorrectStoryPointsAlert">
            <div class="alert alert-danger mx-auto mt-3 text-center" role="alert">
              Completed story points must be smaller than or equal to assigned story points.
            </div>
          </ng-container>
          <ng-container *ngIf="incompleteAlert">
            <div class="alert alert-danger mx-auto mt-3 text-center" role="alert">
              Please complete all fields before submitting.
            </div>
          </ng-container>
        </div>
        <div class="row">
          <ng-container *ngIf="!submitted">
            <div class="col mx-auto mt-3" *ngIf="project != ''">
              <h5>Project:</h5> {{ project }}
            </div>
            <div class="col-9 mx-auto mt-3" *ngIf="fileList != ''">
              <h5>Files:</h5>
              <div *ngFor="let file of fileList">
                <b>Name:</b> {{ file.name }} <p class="badge badge-danger ml-2" id="remove" title="Remove"
                  (click)="removeFromFileList(file)">X</p>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="submitted">
            <div class="alert alert-success mx-auto mt-3 text-center" role="alert">
              Sprint report has been successfully submitted.
            </div>
          </ng-container>
        </div>
      </div>

      <div class="tab-pane fade" id="edit-reports">
          <div class="row mt-4" (change)="validateEdit()">
            <div class="col-3">
              <h4 class="mt-1 text-center">Add Files: </h4>
            </div>
            <div class="col">
              <div class="input-group">
                  <div class="input-group-prepend">
                      <button class="btn btn-outline-secondary dropdown-toggle" style="width:100px;" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Project</button>
                      <div class="dropdown-menu">
                        <div *ngFor="let project of projectList | async">
                          <p class="dropdown-item" (click)="setProjectEdit(project)"> {{ project }}</p>
                        </div>
                      </div>
                  </div>
                <div class="input-group-prepend ml-2">
                    <button class="btn btn-outline-secondary dropdown-toggle" style="width:100px;" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Iterations</button>
                    <div class="dropdown-menu">
                      <div *ngFor="let iter of iterationListEdit | async">
                        <p class="dropdown-item" (click)="setIteration(iter)"> {{ iter }}</p>
                      </div>
                    </div>
                </div>
                <div class="input-group-append ml-2">

                  <button class="btn btn-secondary" type="button" (click)="submitEdit()" [disabled]="!iterationChoice && !filesEdit">Submit</button>
                </div>
                <button class="btn btn-secondary ml-2" type="button" (click)="submitEdit()"
                  [disabled]="!completeEdit">Submit</button>
              </div>
            </div>
          </div>
          <div class="row">
            <ng-container *ngIf="!submittedEdit">
             <div class="col mx-auto mt-3" *ngIf="projectEdit">
                <h5>Project:</h5> {{ projectEdit }}
              </div>
              <div class="col mx-auto mt-3" *ngIf="iterationChoice != ''">
                <h5>Iteration:</h5> {{ iterationChoice }}
              </div>
              <div class="col-9 mx-auto mt-3" *ngIf="filesEdit">
                <h5>Files:</h5> 
                <div *ngFor="let file of filesEdit">
                  <b>Name:</b> {{ file }} <p class="badge badge-danger ml-2" id="remove" title="Remove" (click)="removeFile(file)">X</p>
                </div>
                <div>
                    <span class="badge badge-success ml-2 btn-file">
                        + <input type="file" (change)="addFile($event)">
                    </span>
              </div>
              </div>
            </ng-container>
            <ng-container *ngIf="submittedEdit">
              <div class="alert alert-success mx-auto mt-3 text-center" role="alert">
                Sprint report has been successfully submitted.
            </div>
          </ng-container>
        </div>
      </div>

    </div>

  </div>
</div>
